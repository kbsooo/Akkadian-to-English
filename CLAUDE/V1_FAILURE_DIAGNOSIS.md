# V1 ëª¨ë¸ ì‹¤íŒ¨ ì¢…í•© ì§„ë‹¨ ë³´ê³ ì„œ (ìµœì¢…)

## ì¦ìƒ
```
Sample outputs:
  [0]  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!...
  [1]  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!...
```

í•™ìŠµ ì§€í‘œëŠ” ì–‘í˜¸í–ˆìŒ (ë¡œì»¬ MPS í•™ìŠµ: Epoch 5, BLEU 36.45, chrF 37.44)ì—ë„ ë¶ˆêµ¬í•˜ê³ , Kaggle ì¶”ë¡  ì‹œ ë¬´ì˜ë¯¸í•œ `!` ë°˜ë³µ ì¶œë ¥.

---

## ğŸ”´ğŸ”´ğŸ”´ í•µì‹¬ ì›ì¸: ëª¨ë¸ ì•„í‚¤í…ì²˜ ë¶ˆì¼ì¹˜

### ë°œê²¬ëœ ë‘ ê°œì˜ ë‹¤ë¥¸ ëª¨ë¸

| í•­ëª© | checkpoint-1320 (ë¡œì»¬) | akkadian-v1 (Kaggle ì—…ë¡œë“œ) |
|------|------------------------|----------------------------|
| **ìœ„ì¹˜** | `src/outputs/baseline_mps/tier3/` | `models/akkadian-v1/` |
| **d_model** | 1472 | 1536 |
| **d_ff** | 3584 | 3968 |
| **num_layers** (encoder) | 12 | 18 |
| **num_decoder_layers** | 4 | 6 |
| **num_heads** | 6 | 12 |
| **ì•„í‚¤í…ì²˜** | **ByT5-Small** âœ… | **ByT5-Base** âŒ |
| **í•™ìŠµ í™˜ê²½** | ë¡œì»¬ Mac (MPS) | Kaggle T4 GPU |
| **output_dir** | `outputs/baseline_mps/` | `/kaggle/working/akkadian_v1` |
| **í•™ìŠµ ê²°ê³¼** | BLEU 36.45 âœ… | ë¶ˆëª… (!!!... ì¶œë ¥) |

### ë¬¸ì œì˜ í•µì‹¬

```
ğŸ  ë¡œì»¬ì—ì„œ í•™ìŠµí•œ ëª¨ë¸: ByT5-Small (checkpoint-1320) â†’ BLEU 36.45 ë‹¬ì„±
                          â†“
                    âŒ ì—…ë¡œë“œ ì•ˆë¨

â˜ï¸ Kaggleì— ì—…ë¡œë“œëœ ëª¨ë¸: ByT5-Base (akkadian-v1) â†’ ë³„ë„ í•™ìŠµ, ê²°ê³¼ ë¶ˆëª…
                          â†“
                    Kaggle ì¶”ë¡ ì—ì„œ ì‚¬ìš©
                          â†“
                    "!!!!!!!!..." ì¶œë ¥
```

**ê²°ë¡ : ì„±ê³µì ìœ¼ë¡œ í•™ìŠµëœ ByT5-Small ëª¨ë¸ì´ Kaggleì— ì—…ë¡œë“œë˜ì§€ ì•Šì•˜ê³ , ë³„ë„ë¡œ í•™ìŠµëœ ByT5-Base ëª¨ë¸ì´ ì‚¬ìš©ë¨**

---

## ê¸°ì—¬ ì›ì¸ (2ì°¨)

### ğŸŸ¡ Issue #1: Train/Test ë°ì´í„° ë ˆë²¨ ë¶ˆì¼ì¹˜

| êµ¬ë¶„ | Train.csv | Test.csv |
|------|-----------|----------|
| **ë ˆë²¨** | ë¬¸ì„œ (Document) | ë¬¸ì¥ (Sentence) |
| **í‰ê·  ê¸¸ì´** | 426ì | 169ì |
| **ìƒ˜í”Œ ìˆ˜** | 1,561 ë¬¸ì„œ | ~4,000 ë¬¸ì¥ |

**ì˜í–¥:** ëª¨ë¸ì´ ê¸´ ì…ë ¥ì—ë§Œ ìµœì í™”ë˜ì–´ ì§§ì€ ë¬¸ì¥ì—ì„œ ë¶ˆì•ˆì •

### ğŸŸ¡ Issue #2: Test OOV ë¬¸ì

```
Testì—ì„œ ë°œê²¬ëœ Trainì— ì—†ëŠ” ë¬¸ì:
  'â€' (U+201E) - ë…ì¼ì‹ ë”°ì˜´í‘œ, 6íšŒ ì¶œí˜„
```

### ğŸŸ¡ Issue #3: Tokenizer ë¶ˆì¼ì¹˜

```python
# Training
tokenizer = AutoTokenizer.from_pretrained("google/byt5-base")

# Inference
tokenizer = ByT5Tokenizer(extra_ids=125)  # ìˆ˜ë™ ìƒì„±
```

---

## í•´ê²° ë°©ì•ˆ

### ğŸ…°ï¸ ì¦‰ì‹œ í•´ê²° (Quick Fix) - ê¶Œì¥

**ì˜¬ë°”ë¥¸ ì²´í¬í¬ì¸íŠ¸ ì—…ë¡œë“œ:**
```bash
# checkpoint-1320 (ByT5-Small, BLEU 36.45)ì„ Kaggle Datasetìœ¼ë¡œ ì—…ë¡œë“œ
# í˜„ì¬ models/akkadian-v1/ ë‚´ìš©ì„ êµì²´

# í•„ìš” íŒŒì¼:
src/outputs/baseline_mps/tier3/checkpoint-1320/
â”œâ”€â”€ config.json              # ByT5-Small ì„¤ì •
â”œâ”€â”€ model.safetensors        # í•™ìŠµëœ ê°€ì¤‘ì¹˜
â”œâ”€â”€ tokenizer_config.json
â”œâ”€â”€ special_tokens_map.json
â””â”€â”€ generation_config.json
```

### ğŸ…±ï¸ ê·¼ë³¸ í•´ê²° (Proper Fix)

**Kaggleì—ì„œ ì˜¬ë°”ë¥¸ ì„¤ì •ìœ¼ë¡œ ì¬í•™ìŠµ:**
```python
# akka_v2_train.py
model_name = "google/byt5-small"  # baseê°€ ì•„ë‹Œ small ì‚¬ìš© (ë¡œì»¬ê³¼ ë™ì¼)

# ë˜ëŠ” Tier3 ë¬¸ì¥ ë°ì´í„°ë¡œ ì²˜ìŒë¶€í„° ì œëŒ€ë¡œ í•™ìŠµ
train_df = pd.read_csv("sentence_pairs_q70_pattern.csv")  # 2,350ê°œ ë¬¸ì¥ ìŒ
```

---

## V2 ê¶Œì¥ êµ¬ì¡°

```
src/
â”œâ”€â”€ common/
â”‚   â””â”€â”€ preprocessing.py      # ê³µí†µ ì „ì²˜ë¦¬ í•¨ìˆ˜
â”œâ”€â”€ notebooks/
â”‚   â”œâ”€â”€ akka_v2_train.py     # Tier3 ë¬¸ì¥ ë°ì´í„° + ByT5-Small
â”‚   â””â”€â”€ akka_v2_infer.py     # ë™ì¼ ì „ì²˜ë¦¬ & í† í¬ë‚˜ì´ì €
â””â”€â”€ outputs/
    â””â”€â”€ sentence_pairs_q70_pattern.csv  # 2,350ê°œ ë¬¸ì¥ ìŒ
```

### V2 ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] **ëª¨ë¸ ì¼ê´€ì„±**: í•™ìŠµê³¼ ì¶”ë¡ ì—ì„œ ë™ì¼ ì•„í‚¤í…ì²˜ ì‚¬ìš©
- [ ] **ë°ì´í„°**: `sentence_pairs_q70_pattern.csv` (Tier3) ì‚¬ìš©
- [ ] **ì „ì²˜ë¦¬**: ê³µí†µ ëª¨ë“ˆë¡œ ë¶„ë¦¬í•˜ì—¬ Train/Inference ë™ì¼í•˜ê²Œ
- [ ] **OOV ì²˜ë¦¬**: `â€` ë“± íŠ¹ìˆ˜ ë¬¸ì ì²˜ë¦¬ ì¶”ê°€
- [ ] **Tokenizer**: `AutoTokenizer.from_pretrained()` ì¼ê´€ ì‚¬ìš©
- [ ] **ì—…ë¡œë“œ ê²€ì¦**: ì—…ë¡œë“œ ì „ config.jsonì˜ d_model í™•ì¸

---

## ê²°ë¡ 

**V1 ì‹¤íŒ¨ì˜ í•µì‹¬ ì›ì¸:**

| ìˆœìœ„ | ì›ì¸ | ì˜í–¥ë„ |
|------|------|--------|
| **1** | **ëª¨ë¸ ì•„í‚¤í…ì²˜ ë¶ˆì¼ì¹˜ (Small vs Base)** | ğŸ”´ğŸ”´ ì¹˜ëª…ì  |
| 2 | Train(ë¬¸ì„œ) vs Test(ë¬¸ì¥) ë¶„í¬ ë¶ˆì¼ì¹˜ | ğŸŸ¡ ì¤‘ê°„ |
| 3 | Test OOV ë¬¸ì ë¯¸ì²˜ë¦¬ | ğŸŸ¡ ì¤‘ê°„ |
| 4 | Tokenizer ìƒì„± ë°©ì‹ ì°¨ì´ | ğŸŸ¡ ì¤‘ê°„ |

**í•µì‹¬ êµí›ˆ:**
> 1. ì—…ë¡œë“œí•˜ëŠ” ëª¨ë¸ì´ í•™ìŠµí•œ ëª¨ë¸ê³¼ ë™ì¼í•œì§€ ë°˜ë“œì‹œ ê²€ì¦
> 2. config.jsonì˜ d_model, num_layers ë“± í™•ì¸ í•„ìˆ˜
> 3. ë¡œì»¬ í•™ìŠµ â†’ Kaggle ë°°í¬ íŒŒì´í”„ë¼ì¸ ëª…í™•íˆ ì •ë¦½

**ë‹¤ìŒ ë‹¨ê³„:**
1. **ì¦‰ì‹œ**: `checkpoint-1320` (ByT5-Small)ì„ Kaggleì— ì—…ë¡œë“œí•˜ì—¬ ì¬ì¶”ë¡ 
2. **ê²€ì¦**: ì¶”ë¡  ê²°ê³¼ê°€ ì •ìƒì ì¸ ì˜ì–´ í…ìŠ¤íŠ¸ì¸ì§€ í™•ì¸
3. **ê°œì„ **: Tier3 ë°ì´í„°ë¡œ V2 ì¬í•™ìŠµ (ë¬¸ì¥ ë ˆë²¨ ìµœì í™”)

---

*Updated: 2026-01-30*
*Root Cause: Model architecture mismatch (ByT5-Small trained locally vs ByT5-Base uploaded to Kaggle)*
